!function(t){function e(t,e,n){t.prototype=Object.create(e.prototype),r(n)&&s(t.prototype,n)}function r(t){return null!==t&&"object"==typeof t}function n(t){return Array.prototype.slice.apply(t)}function o(t){return i(t)===!1}function i(t){return"undefined"==typeof t}function s(t){t||(t={});var e,i,s,u,a,c,h,p=n(arguments).slice(1).filter(o),f=p.length;for(c=0;f>c;c++)if((e=p[c])&&r(e))for(s=Object.keys(e),a=s.length,h=0;a>h;h++)u=s[h],i=e[u],t[u]=i;return t}function r(t){return null!==t&&"object"==typeof t}function u(){this._events={}}function a(t){u.call(this),this.routes=t||{},this.current=null,this.preparedRoute=null}Array.isArray||function(t){return r(t)&&t instanceof Array==!0};u.prototype={on:function(t,e){return this._events.hasOwnProperty(t)||(this._events[t]=[]),this._events[t].push(e),this},off:function(t,e){var r,n=this._events[t];for(r=0;r<n.length;r++)n[r]==e&&n.splice(r,1);return this},emit:function(t){var e,r,i,s=n(arguments).slice(1);if(this._events.hasOwnProperty(t))for(i=this._events[t],r=new Array(i.length),e=0;e<i.length;e++)r[e]=i[e].apply(this,s);return r&&r.length>0?r.every(function(t){return o(t)?t:!0}):!0},removeAllListeners:function(){var t,e,r,n,o,i=Object.keys(this._events),s=i.length;for(t=0;s>t;t++)for(o=i[t],n=this._events[o],r=n.length,e=0;r>e;e++)n.splice(e,1)}},a.createPathRegExp=function(t,e){e=e||{};var r=e.caseInsensitiveMatch,n={originalPath:t,regexp:t},o=n.params=[];return t=t.replace(/([().])/g,"\\$1").replace(/(\/)?{(\w+)([\?\*])?}/g,function(t,e,r,n){var i="?"===n?n:null,s="*"===n?n:null;return o.push({name:r,optional:!!i}),e=e||"",""+(i?"":e)+"(?:"+(i?e:"")+(s&&"(.+?)"||"([^/]+)")+(i||"")+")"+(i||"")}).replace(/([\/$\*])/g,"\\$1"),n.regexp=new RegExp("^"+t+"$",r?"i":""),n},e(a,u,{constructor:a,when:function(t,e){var r=this.routes;if(this.routes.hasOwnProperty(e))throw new Error('Redefinition of route "'+t+'"');return r[t]=s(e,a.createPathRegExp(t)),this},prepare:function(t){var e=this.current;return this.preparedRoute=t,this.emit("routeChangeStart",t,e)?!0:!1},commit:function(){var t=this.preparedRoute;this.current=t},go:function(t){var e=this.parse(t);this.prepare(e)||this.emit("routeNotFound",t)},parse:function(t){for(var e,r,n=Object.keys(this.routes),o=this.routes,i=0;i<n.length;i++)if(e=o[n[i]],r=t.match(e.regexp))return e}});var c={};t.router={Router:a,routes:c,router:new a(c)}}(window);